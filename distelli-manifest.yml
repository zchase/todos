zchase/meteor:

  #Learn about the distelli-manifest.yml at https://www.distelli.com/docs/reference/distelli-manifest
  PkgInclude:
    - '*'

  Build:
    - echo "Begin Build"
    - npm install
    #- npm test

  PreInstall:
    - echo "Begin PreInstall"
    - sudo apt-get -y update
    - sudo apt-get install mongodb-server -y
    - sudo apt-get install -y software-properties-common
    - sudo apt-get install -y python-software-properties python g++ make
    - 'if [ -a /usr/local/bin/meteor ]; then'
    -     echo "Meteor is already installed"
    - else
    -     sudo curl https://install.meteor.com | /bin/sh
    - fi
    - 'if [ -a /etc/nginx ]; then'
    -     echo "NGINX is already installed"
    - else
    -     sudo apt-get install nginx -y
    - fi
    - 'if [ -a /etc/nginx/sites-enabled/default ]; then'
    -     sudo rm /etc/nginx/sites-enabled/default
    - else
    -     echo "Default NGINX already removed"
    - fi

  PostInstall:
    - echo "Begin PostInstall"
    - sudo mv -f todos /etc/nginx/sites-available/todos
    - sudo mv -f todos.conf /etc/init/todos.conf
    - sudo ln -sf /etc/nginx/sites-available/todos /etc/nginx/sites-enabled/todos
    - sudo service nginx restart -y
    - /usr/local/bin/meteor build ./build --directory
    - cd build/bundle/programs/server/
    - npm install

  Exec:
    - /usr/bin/node build/bundle/main.js